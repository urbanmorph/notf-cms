<!DOCTYPE html>
<html lang="en" data-lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bengaluru East City Corporation</title>
    <link rel="stylesheet" href="css/styles.css?v=6">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
</head>
<body data-page="east">
        <nav class="navbar">
        <div class="container">
            <div class="nav-brand"><img src="images/gba-logo.png" alt="GBA" class="brand-logo"><span data-i18n="nav.brand">Corporations of Greater Bengaluru</span></div>
            <div class="hamburger" onclick="toggleMenu()">
                <span></span>
                <span></span>
                <span></span>
            </div>
            <div class="nav-tabs" id="navTabs">
                <a href="index.html" class="nav-tab" data-i18n="nav.home">Home</a>
                <div class="dropdown">
                    <button class="dropdown-toggle" onclick="toggleDropdown(event)">
                        <span data-i18n="nav.corporations">Corporations</span>
                        <span class="dropdown-arrow">‚ñº</span>
                    </button>
                    <div class="dropdown-menu">
                        <a href="north.html" class="dropdown-item" data-i18n="corporations.north">Bengaluru North</a>
                        <a href="south.html" class="dropdown-item" data-i18n="corporations.south">Bengaluru South</a>
                        <a href="east.html" class="dropdown-item" data-i18n="corporations.east">Bengaluru East</a>
                        <a href="west.html" class="dropdown-item" data-i18n="corporations.west">Bengaluru West</a>
                        <a href="central.html" class="dropdown-item" data-i18n="corporations.central">Bengaluru Central</a>
                    </div>
                </div>
                <a href="track.html" class="nav-tab" data-i18n="nav.trackComplaint">Track Complaint</a>
                <a href="admin/login.html?corp=east" class="admin-login-btn" data-i18n="nav.admin">Admin</a>
                <a href="api-docs.html" class="nav-tab">API Docs</a>
                <button class="lang-toggle" onclick="toggleLanguage()" title="Switch Language">
                    <span class="lang-en active">EN</span>
                    <span class="lang-separator">|</span>
                    <span class="lang-kn">‡≤ï‡≤®‡≥ç‡≤®‡≤°</span>
                </button>
            </div>
        </div>
    </nav>
    <section class="corp-header">
        <div class="container">
            <h1>Bengaluru East City Corporation</h1>
            <div class="commissioner-info">
                <div class="commissioner-photo">
                    <div class="placeholder-photo">
                        <svg width="120" height="120" viewBox="0 0 120 120">
                            <circle cx="60" cy="60" r="60" fill="#FBC831"/>
                            <text x="60" y="75" text-anchor="middle" fill="white" font-size="48" font-weight="bold">RD</text>
                        </svg>
                    </div>
                </div>
                <div class="commissioner-details">
                    <h2>Sri. Ramesh D S, I.A.S.</h2>
                    <p class="commissioner-title">City Corporation Commissioner</p>
                    <div class="contact-methods">
                        <a href="tel:8762708901" class="contact-btn whatsapp" target="_blank">
                            <span class="icon">üì±</span> Phone: 87627 08901
                        </a>
                        <a href="mailto:commissioner.becc@gmail.com" class="contact-btn email">
                            <span class="icon">üìß</span> commissioner.becc@gmail.com
                        </a>
                        <a href="tel:08028512300" class="contact-btn telegram" target="_blank">
                            <span class="icon">üö®</span> Control Room: 080-28512300
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <section class="dashboard-section">
        <div class="container">
            <h2 class="section-title" data-i18n="dashboard.title">Performance Dashboard</h2>
            <div class="stats-grid">
                <div class="stats-card">
                    <h3 data-i18n="dashboard.totalGrievances">Total Grievances</h3>
                    <div class="value" id="totalIssues">Loading...</div>
                </div>
                <div class="stats-card">
                    <h3 data-i18n="dashboard.closed">Closed</h3>
                    <div class="value" id="closedIssues">Loading...</div>
                </div>
                <div class="stats-card">
                    <h3 data-i18n="dashboard.open">Open</h3>
                    <div class="value" id="openIssues">Loading...</div>
                </div>
                <div class="stats-card">
                    <h3 data-i18n="dashboard.resolutionRate">Resolution Rate</h3>
                    <div class="value" id="resolutionRate">Loading...</div>
                </div>
            </div>
        </div>
    </section>

    
    <!-- Floating Action Buttons -->
    <div class="floating-buttons">
        <a href="chat-complaint.html?corp=east" class="floating-btn chat-btn" title="Chat Interface (New!)" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); animation: pulse 2s infinite;">
            üí¨
        </a>
        <button class="floating-btn complaint-btn" onclick="openModal('complaintModal')" title="File Complaint (Traditional Form)">
            üìù
        </button>
        <button class="floating-btn whatsapp-btn" onclick="openWhatsApp()" title="WhatsApp">
            üì±
        </button>
        <button class="floating-btn telegram-btn" onclick="openTelegram()" title="Telegram">
            ‚úàÔ∏è
        </button>
    </div>

    <!-- Complaint Modal -->
    <div id="complaintModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" data-i18n="complaint.fileComplaint">File a Complaint</h2>
                <button class="modal-close" onclick="closeModal('complaintModal')">√ó</button>
            </div>
            <div class="modal-body">
                <form id="complaintForm" onsubmit="handleComplaintSubmit(event); return false;">
                    <input type="hidden" name="corporation" id="complaintCorporation" value="Bengaluru East City Corporation">
                    <div class="form-group">
                        <label class="form-label"><span data-i18n="complaint.yourName">Your Name</span> *</label>
                        <input type="text" name="name" class="form-input" required placeholder="Enter your full name">
                    </div>
                    <div class="form-group">
                        <label class="form-label"><span data-i18n="complaint.phone">Phone Number</span> *</label>
                        <input type="tel" name="phone" class="form-input" required pattern="[0-9]{10}" placeholder="10-digit mobile number">
                    </div>
                    <div class="form-group">
                        <label class="form-label" data-i18n="complaint.email">Email</label>
                        <input type="email" name="email" class="form-input" data-i18n-placeholder="complaint.emailPlaceholder" placeholder="For updates (optional)">
                    </div>
                    <div class="form-group">
                        <label class="form-label"><span data-i18n="complaint.issueType">Issue Type</span> *</label>
                        <select name="issueType" id="issueType" class="form-select" required>
                            <option value="">Loading categories...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label"><span data-i18n="complaint.location">Location of Issue</span> *</label>
                        <input type="text" name="address" class="form-input" data-i18n-placeholder="complaint.locationPlaceholder" placeholder="Street address or area" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" data-i18n="complaint.landmark">Landmark</label>
                        <input type="text" name="landmark" class="form-input" data-i18n-placeholder="complaint.landmarkPlaceholder" placeholder="Nearby landmark (optional)">
                    </div>
                    <div class="form-group">
                        <label class="form-label" data-i18n="complaint.pinLocation">Pin Location on Map</label>
                        <div class="location-picker">
                            <div class="location-actions">
                                <button type="button" class="btn-location" onclick="useMyLocation()">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <circle cx="12" cy="12" r="10"></circle>
                                        <circle cx="12" cy="12" r="3"></circle>
                                        <line x1="12" y1="2" x2="12" y2="6"></line>
                                        <line x1="12" y1="18" x2="12" y2="22"></line>
                                        <line x1="2" y1="12" x2="6" y2="12"></line>
                                        <line x1="18" y1="12" x2="22" y2="12"></line>
                                    </svg>
                                    <span data-i18n="complaint.useMyLocation">Use My Location</span>
                                </button>
                                <span class="location-status" id="locationStatus"></span>
                            </div>
                            <div id="locationMap" class="location-map"></div>
                            <input type="hidden" name="latitude" id="complaintLatitude">
                            <input type="hidden" name="longitude" id="complaintLongitude">
                            <div class="location-coords" id="locationCoords" style="display: none;">
                                <small>üìç <span id="coordsDisplay"></span></small>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label"><span data-i18n="complaint.description">Description</span> *</label>
                        <textarea name="description" class="form-textarea" required data-i18n-placeholder="complaint.descriptionPlaceholder" placeholder="Please describe the issue in detail"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label" data-i18n="complaint.uploadPhoto">Upload Photo (Optional, max 2 MB)</label>
                        <input type="file"
                               id="complaintPhoto"
                               name="photo"
                               class="form-file"
                               accept="image/jpeg,image/png,image/webp,image/heic"
                               capture="environment">
                        <div id="photoError" class="error-message" style="display:none; color: #dc3545; font-size: 14px; margin-top: 8px;"></div>
                        <div id="photoPreview" class="photo-preview" style="display:none; margin-top: 15px;"></div>
                    </div>
                    <button type="submit" class="btn-primary" id="submitComplaintBtn" data-i18n="complaint.submit">Submit Complaint</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Admin Login Modal - Redirects to dedicated login page -->
    <div id="adminModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Admin Login</h2>
                <button class="modal-close" onclick="closeModal('adminModal')">√ó</button>
            </div>
            <div class="modal-body" style="text-align: center; padding: 2rem;">
                <p style="margin-bottom: 1.5rem; color: #666;">You will be redirected to the secure admin portal.</p>
                <a href="admin/login.html" class="btn-primary" style="display: inline-block; text-decoration: none;">Go to Admin Portal</a>
            </div>
        </div>
    </div>



    <!-- Top Issues (Compact) -->
    <section class="section" style="padding-top: 1rem; padding-bottom: 1rem;">
        <div class="container">
            <div id="topIssuesContainer">
                <!-- Populated by JavaScript -->
            </div>
        </div>
    </section>

    <!-- Geographic Coverage Section -->
    <section class="section">
        <div class="container">
            <h2 class="section-title" data-i18n="geographic.title">Geographic Coverage</h2>
            <p style="text-align: center; color: var(--text-secondary); margin-bottom: 1.5rem;" data-i18n="geographic.subtitle">
                Interactive map showing ward boundaries and issue density across the corporation
            </p>
            <div style="background: white; padding: 2rem; border-radius: 12px; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);">
                <div id="map" style="height: 500px; width: 100%; border-radius: 8px;"></div>
            </div>
        </div>
    </section>

    <!-- Charts and Analytics Section -->
    <section class="charts-section">
        <div class="container">
            <h2 class="section-title" data-i18n="charts.title">Performance Analytics & Trends</h2>

            <div class="charts-grid">
                <!-- Resolution Rate Trend -->
                <div class="chart-container">
                    <h3 class="chart-title" data-i18n="charts.resolutionTrend">Resolution Rate Trend (2020-2025)</h3>
                    <div class="chart-canvas">
                        <canvas id="trendChart"></canvas>
                    </div>
                </div>

                <!-- Grievance Volume -->
                <div class="chart-container">
                    <h3 class="chart-title" data-i18n="charts.yearlyVolume">Yearly Grievance Volume</h3>
                    <div class="chart-canvas">
                        <canvas id="volumeChart"></canvas>
                    </div>
                </div>

                <!-- Category Breakdown -->
                <div class="chart-container">
                    <h3 class="chart-title" data-i18n="charts.topCategories">Top Issue Categories</h3>
                    <div class="chart-canvas">
                        <canvas id="categoryChart"></canvas>
                    </div>
                </div>

                <!-- Closed vs Open Comparison -->
                <div class="chart-container">
                    <h3 class="chart-title" data-i18n="charts.closedVsOpen">Closed vs Open Grievances</h3>
                    <div class="chart-canvas">
                        <canvas id="comparisonChart"></canvas>
                    </div>
                </div>

                <!-- Seasonal Patterns -->
                <div class="chart-container">
                    <h3 class="chart-title" data-i18n="charts.seasonal">Monthly Distribution (Seasonal Patterns)</h3>
                    <div class="chart-canvas">
                        <canvas id="seasonalChart"></canvas>
                    </div>
                </div>
            </div>
            <!-- Data Attribution -->
            <div class="data-attribution" style="margin-top: 2.5rem;">
                <p><strong>Data Source:</strong> BBMP Grievances Data (2020-2025) via <a href="https://data.opencity.in/dataset/bbmp-grievances-data" target="_blank">OpenCity.in</a></p>
                <p class="text-muted small"><strong>Ward Mapping:</strong> Based on official GBA delimitation (2025 reorganization to 369 wards). Data accuracy: 62.3% of total grievances mapped. Historical data (2020-2024) uses pre-2025 ward system (198 wards).</p>
            </div>
        </div>
    </section>



    <!-- Contact Information Section -->
    <section class="contact-section">
        <div class="container">
            <h2 class="section-title" data-i18n="contact.title">Contact Information</h2>
            <p style="text-align: center; color: var(--text-secondary); margin-bottom: 1.5rem;" data-i18n="contact.subtitle">
                Official contact details for corporation officials
            </p>
            <div id="contactContainer">
                <!-- Populated by JavaScript -->
            </div>
        </div>
    </section>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="js/i18n.js"></script>
    <script src="js/data.js?v=10"></script>
    <script src="js/charts.js?v=10"></script>
    <script src="js/script.js?v=10"></script>
    <script src="https://unpkg.com/@turf/turf@6/turf.min.js"></script>
    <script src="js/complaint-form.js?v=4"></script>
    <script>loadCorporationDashboard('east');</script>
    <!-- Footer -->
    <footer class="site-footer">
        <div class="container">
            <div class="footer-content">
                <!-- About Section -->
                <div class="footer-section">
                    <img src="images/gba-logo.png" alt="GBA Logo" class="footer-logo">
                    <h3 data-i18n="footer.about">Greater Bengaluru Authority</h3>
                    <p class="footer-about" data-i18n="footer.aboutDesc">
                        Civic grievance tracking and transparency platform for all five corporations of Greater Bengaluru.
                    </p>
                </div>

                <!-- Corporations -->
                <div class="footer-section">
                    <h3 data-i18n="footer.corporations">Corporations</h3>
                    <ul class="footer-links">
                        <li><a href="north.html" data-i18n="corporations.north">Bengaluru North</a></li>
                        <li><a href="south.html" data-i18n="corporations.south">Bengaluru South</a></li>
                        <li><a href="east.html" data-i18n="corporations.east">Bengaluru East</a></li>
                        <li><a href="west.html" data-i18n="corporations.west">Bengaluru West</a></li>
                        <li><a href="central.html" data-i18n="corporations.central">Bengaluru Central</a></li>
                    </ul>
                </div>

                <!-- Features -->
                <div class="footer-section">
                    <h3 data-i18n="footer.features">Features</h3>
                    <ul class="footer-links">
                        <li><a href="track.html" data-i18n="footer.trackComplaint">Track Complaint</a></li>
                        <li><a href="index.html#data-insights" data-i18n="footer.dataInsights">Data Insights</a></li>
                        <li><a href="index.html#about" data-i18n="footer.aboutPlatform">About the Platform</a></li>
                    </ul>
                </div>

                <!-- Data & Resources -->
                <div class="footer-section">
                    <h3 data-i18n="footer.dataResources">Data & Resources</h3>
                    <ul class="footer-links">
                        <li><a href="https://data.opencity.in/dataset/bbmp-grievances-data" target="_blank" data-i18n="footer.bbmpData">BBMP Grievances Data</a></li>
                        <li><a href="https://data.opencity.in/dataset/gba-wards-delimitation-2025" target="_blank" data-i18n="footer.wardData">GBA Ward Delimitation</a></li>
                        <li><a href="https://github.com/urbanmorph/notf-cms" target="_blank" data-i18n="footer.github">GitHub Repository</a></li>
                    </ul>
                </div>
            </div>

            <div class="footer-bottom">
                <p>&copy; 2026 <span data-i18n="footer.copyright">Corporations of Greater Bengaluru. Data sourced from</span> <a href="https://data.opencity.in" target="_blank">OpenCity.in</a></p>
            </div>
        </div>
    </footer>

</body>
</html>